--EJ1 
SELECT ACTOR_NOMBRE FROM ACTOR
WHERE DEBUT - TO_CHAR(FECHA_NAC,'YYYY')<20;
--EJ2
SELECT ACTOR_NOMBRE 
FROM ACTOR
WHERE ACTOR_ID NOT IN (SELECT ACTOR_ID FROM REPARTO);
--EJ3 
SELECT ACTOR_NOMBRE
FROM ACTOR 
WHERE DEBUT IS NOT NULL AND FECHA_NAC = (SELECT MAX(FECHA_NAC)FROM ACTOR WHERE UPPER(TIPO_DEBUT)='CINE');
--EJ4 
SELECT ACTOR_NOMBRE 
FROM ACTOR
JOIN REPARTO ON ACTOR.ACTOR_ID = REPARTO.ACTOR_ID
GROUP BY ACTOR_NOMBRE,ACTOR.ACTOR_ID
HAVING COUNT(REPARTO.ACTOR_ID) >1;
--EJ5 
SELECT SERIE_TITULO,TEMPORADA,COUNT(*) NÚMERO DE CAPITULOS"
FROM SERIE
JOIN  CAPITULO ON SERIE.SERIE_ID = CAPITULO.SERIE_ID
GROUP BY SERIE_TITULO,TEMPORADA;
--EJ6 
SELECT DISTINCT SERIE_TITULO,DECODE(TEMPORADA,null,'No tiene',TEMPORADA)"TEMPORADA",COUNT(CAPITULO) "NÚMERO DE CAPITULOS"
FROM SERIE
FULL OUTER JOIN CAPITULO ON SERIE.SERIE_ID = CAPITULO.SERIE_ID
GROUP BY SERIE_TITULO,TEMPORADA,CAPITULO;
--EJ7 
SELECT SERIE_TITULO FROM SERIE
JOIN REPARTO ON SERIE.SERIE_ID = REPARTO.SERIE_ID
GROUP BY SERIE_TITULO,REPARTO.SERIE_ID
HAVING COUNT(PERSONAJE_NOMBRE) =(SELECT MAX(COUNT(PERSONAJE_NOMBRE)) FROM REPARTO GROUP BY SERIE_ID);
--EJ8 
SELECT ACTOR_NOMBRE,NACIONALIDAD
FROM ACTOR A1
WHERE FECHA_NAC = (SELECT MIN(FECHA_NAC) FROM ACTOR A2 A1.NACIONALIDAD=A2.NACIONALIDAD)
ORDER BY NACIONALIDAD DESC;
--EJ9 
INSERT INTO CAPITULO
SELECT SERIE_ID,2,2,'Examen BBDD',45
FROM CAPITULO
GROUP BY SERIE_ID
HAVING COUNT(CAPITULO) = (SELECT MIN(COUNT(CAPITULO)) FROM CAPITULO GROUP BY SERIE_ID);
--EJ10 
UPDATE ACTOR SET (TIPO_DEBUT) = (SELECT DISTINCT TIPO_DEBUT FROM ACTOR WHERE LENGTH(TIPO_DEBUT)=(SELECT MIN(LENGTH(TIPO_DEBUT)) FROM ACTOR))
WHERE ACTOR_ID='A002' ;